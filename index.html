<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hardware Master Test - ANH DUY</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background: #0f172a; color: white; font-family: 'Segoe UI', sans-serif; height: 100vh; overflow: hidden; margin:0; display: flex; }
        .glass { background: rgba(255, 255, 255, 0.05); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
        
        /* SIDEBAR NAVIGATION */
        .nav-item { transition: 0.3s; cursor: pointer; padding: 0.8rem 1.2rem; display: flex; align-items: center; border-radius: 12px; margin-bottom: 0.5rem; font-size: 13px; font-weight: 600; color: #94a3b8; }
        .nav-item:hover { background: rgba(59, 130, 246, 0.1); color: #3b82f6; }
        .nav-item.active { background: #3b82f6 !important; color: white !important; box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3); }
        
        /* TAB SYSTEM */
        .test-section { display: none; height: 100%; width: 100%; animation: fadeIn 0.3s ease-out; flex-direction: column; align-items: center; justify-content: center; position: relative; }
        .test-section.active { display: flex !important; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* KEYBOARD FULL LAYOUT */
        .kb-master-wrapper { background: #111827; padding: 20px; border-radius: 1.5rem; border: 3px solid #334155; display: flex; gap: 12px; box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.7); zoom: 0.82; }
        .key-group { display: flex; flex-direction: column; gap: 4px; }
        .row { display: flex; gap: 4px; }
        .key { background: #1e293b; color: #94a3b8; font-size: 10px; font-weight: bold; width: 42px; height: 42px; display: flex; align-items: center; justify-content: center; border-radius: 6px; border: 1px solid #334155; text-transform: uppercase; transition: 0.1s; }
        .key-pressed { background: #3b82f6 !important; color: white !important; transform: scale(0.9); box-shadow: 0 0 15px #3b82f6; }
        .key-passed { background: #10b981 !important; color: white !important; border-color: #34d399 !important; }

        /* KEY WIDTHS */
        .w-tab { width: 55px; } .w-caps { width: 65px; } .w-shift-l { width: 95px; }
        .w-backspace { width: 89px; } .w-enter { width: 85px; } .w-shift-r { width: 110px; }
        .w-space { width: 288px; } .w-numpad-0 { width: 89px; } .h-double { height: 88px; } .w-ctrl { width: 55px; }

        /* BATTERY & HEALTH STYLES */
        .battery-body { width: 150px; height: 280px; border: 8px solid #334155; border-radius: 20px; position: relative; padding: 8px; display: flex; align-items: flex-end; }
        .battery-head { width: 50px; height: 12px; background: #334155; position: absolute; top: -18px; left: 50%; transform: translateX(-50%); border-radius: 4px 4px 0 0; }
        .battery-level { width: 100%; transition: 1s cubic-bezier(0.4, 0, 0.2, 1); border-radius: 10px; position: relative; }
        .charge-bolt { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 30px; color: white; display: none; }
    </style>
</head>
<body class="p-4 gap-4">

    <div class="w-64 glass rounded-3xl p-6 flex flex-col shadow-2xl">
        <div class="mb-8 text-center">
            <h1 class="text-xl font-black italic text-blue-400 uppercase tracking-tighter">Anh Duy Master</h1>
            <p class="text-[9px] text-gray-500 tracking-[0.2em]">HARDWARE TEST TOOL</p>
        </div>

        <nav class="flex-grow">
            <div onclick="showTab('keyboard')" id="m-keyboard" class="nav-item active"><i class="fas fa-keyboard w-8"></i> BÀN PHÍM</div>
            <div onclick="showTab('camera')" id="m-camera" class="nav-item"><i class="fas fa-camera w-8"></i> CAMERA</div>
            <div onclick="showTab('mic')" id="m-mic" class="nav-item"><i class="fas fa-microphone w-8"></i> MICROPHONE</div>
            <div onclick="showTab('battery')" id="m-battery" class="nav-item"><i class="fas fa-battery-three-quarters w-8"></i> TRẠNG THÁI PIN</div>
            <div onclick="showTab('battery_health')" id="m-battery_health" class="nav-item"><i class="fas fa-heartbeat w-8"></i> SỨC KHỎE PIN</div>
        </nav>

        <div class="border-t border-white/10 pt-4 mt-auto">
            <p class="text-[10px] text-blue-300 font-mono italic text-center">ANHDUY85VT@GMAIL.COM</p>
        </div>
    </div>

    <div class="flex-1 glass rounded-3xl overflow-hidden relative">
        
        <section id="keyboard" class="test-section active">
            <div class="flex justify-between w-full max-w-6xl mb-4 px-10">
                <h2 class="text-blue-400 font-bold uppercase tracking-widest text-xs">Full Keyboard Layout</h2>
                <button onclick="resetKb()" class="bg-red-500 hover:bg-red-600 text-white px-5 py-1 rounded-full text-[10px] font-bold transition-all">RESET</button>
            </div>
            <div class="kb-master-wrapper">
                <div class="key-group">
                    <div class="row">
                        <div class="key" id="key-Escape">Esc</div><div style="width:30px"></div>
                        <div class="key" id="key-F1">F1</div><div class="key" id="key-F2">F2</div><div class="key" id="key-F3">F3</div><div class="key" id="key-F4">F4</div><div style="width:20px"></div>
                        <div class="key" id="key-F5">F5</div><div class="key" id="key-F6">F6</div><div class="key" id="key-F7">F7</div><div class="key" id="key-F8">F8</div><div style="width:20px"></div>
                        <div class="key" id="key-F9">F9</div><div class="key" id="key-F10">F10</div><div class="key" id="key-F11">F11</div><div class="key" id="key-F12">F12</div>
                    </div>
                    <div class="row">
                        <div class="key" id="key-Backquote">`</div><div class="key" id="key-Digit1">1</div><div class="key" id="key-Digit2">2</div><div class="key" id="key-Digit3">3</div><div class="key" id="key-Digit4">4</div><div class="key" id="key-Digit5">5</div><div class="key" id="key-Digit6">6</div><div class="key" id="key-Digit7">7</div><div class="key" id="key-Digit8">8</div><div class="key" id="key-Digit9">9</div><div class="key" id="key-Digit0">0</div><div class="key" id="key-Minus">-</div><div class="key" id="key-Equal">=</div><div class="key w-backspace" id="key-Backspace">Back</div>
                    </div>
                    <div class="row">
                        <div class="key w-tab" id="key-Tab">Tab</div><div class="key" id="key-KeyQ">Q</div><div class="key" id="key-KeyW">W</div><div class="key" id="key-KeyE">E</div><div class="key" id="key-KeyR">R</div><div class="key" id="key-KeyT">T</div><div class="key" id="key-KeyY">Y</div><div class="key" id="key-KeyU">U</div><div class="key" id="key-KeyI">I</div><div class="key" id="key-KeyO">O</div><div class="key" id="key-KeyP">P</div><div class="key" id="key-BracketLeft">[</div><div class="key" id="key-BracketRight">]</div><div class="key w-tab" id="key-Backslash">\</div>
                    </div>
                    <div class="row">
                        <div class="key w-caps" id="key-CapsLock">Caps</div><div class="key" id="key-KeyA">A</div><div class="key" id="key-KeyS">S</div><div class="key" id="key-KeyD">D</div><div class="key" id="key-KeyF">F</div><div class="key" id="key-KeyG">G</div><div class="key" id="key-KeyH">H</div><div class="key" id="key-KeyJ">J</div><div class="key" id="key-KeyK">K</div><div class="key" id="key-KeyL">L</div><div class="key" id="key-Semicolon">;</div><div class="key" id="key-Quote">'</div><div class="key w-enter" id="key-Enter">Enter</div>
                    </div>
                    <div class="row">
                        <div class="key w-shift-l" id="key-ShiftLeft">Shift</div><div class="key" id="key-KeyZ">Z</div><div class="key" id="key-KeyX">X</div><div class="key" id="key-KeyC">C</div><div class="key" id="key-KeyV">V</div><div class="key" id="key-KeyB">B</div><div class="key" id="key-KeyN">N</div><div class="key" id="key-KeyM">M</div><div class="key" id="key-Comma">,</div><div class="key" id="key-Period">.</div><div class="key" id="key-Slash">/</div><div class="key w-shift-r" id="key-ShiftRight">Shift</div>
                    </div>
                    <div class="row">
                        <div class="key w-ctrl" id="key-ControlLeft">Ctrl</div><div class="key" id="key-MetaLeft">Win</div><div class="key" id="key-AltLeft">Alt</div><div class="key w-space" id="key-Space">Space</div><div class="key" id="key-AltRight">Alt</div><div class="key" id="key-MetaRight">Win</div><div class="key" id="key-ContextMenu">Fn</div><div class="key w-ctrl" id="key-ControlRight">Ctrl</div>
                    </div>
                </div>
                <div class="key-group">
                    <div class="row"><div class="key" id="key-PrintScreen">Prt</div><div class="key" id="key-ScrollLock">Scr</div><div class="key" id="key-Pause">Pau</div></div>
                    <div class="row"><div class="key" id="key-Insert">Ins</div><div class="key" id="key-Home">Hm</div><div class="key" id="key-PageUp">Pu</div></div>
                    <div class="row"><div class="key" id="key-Delete">Del</div><div class="key" id="key-End">End</div><div class="key" id="key-PageDown">Pd</div></div>
                    <div style="height:46px"></div>
                    <div class="row flex justify-center"><div class="key" id="key-ArrowUp">↑</div></div>
                    <div class="row"><div class="key" id="key-ArrowLeft">←</div><div class="key" id="key-ArrowDown">↓</div><div class="key" id="key-ArrowRight">→</div></div>
                </div>
                <div class="key-group">
                    <div style="height:46px"></div>
                    <div class="row"><div class="key" id="key-NumLock">Num</div><div class="key" id="key-NumpadDivide">/</div><div class="key" id="key-NumpadMultiply">*</div><div class="key" id="key-NumpadSubtract">-</div></div>
                    <div class="row">
                        <div class="key-group" style="gap:4px">
                            <div class="row"><div class="key" id="key-Numpad7">7</div><div class="key" id="key-Numpad8">8</div><div class="key" id="key-Numpad9">9</div></div>
                            <div class="row"><div class="key" id="key-Numpad4">4</div><div class="key" id="key-Numpad5">5</div><div class="key" id="key-Numpad6">6</div></div>
                        </div>
                        <div class="key h-double" id="key-NumpadAdd">+</div>
                    </div>
                    <div class="row">
                        <div class="key-group" style="gap:4px">
                            <div class="row"><div class="key" id="key-Numpad1">1</div><div class="key" id="key-Numpad2">2</div><div class="key" id="key-Numpad3">3</div></div>
                            <div class="row"><div class="key w-numpad-0" id="key-Numpad0">0</div><div class="key" id="key-NumpadDecimal">.</div></div>
                        </div>
                        <div class="key h-double" id="key-NumpadEnter">Ent</div>
                    </div>
                </div>
            </div>
        </section>

        <section id="camera" class="test-section">
            <h2 class="text-xl font-bold text-blue-400 mb-6 uppercase tracking-widest">Camera Live Check</h2>
            <div class="max-w-2xl w-full rounded-3xl overflow-hidden border-8 border-gray-900 bg-black">
                <video id="v" autoplay playsinline muted class="w-full aspect-video object-cover"></video>
            </div>
            <button onclick="startCam()" class="mt-8 bg-blue-600 hover:bg-blue-500 px-12 py-3 rounded-full font-bold transition-all">BẬT CAMERA</button>
        </section>

        <section id="mic" class="test-section">
            <h2 class="text-xl font-bold text-green-400 mb-6 uppercase tracking-widest">Microphone Level</h2>
            <div class="max-w-md w-full glass p-10 rounded-3xl">
                <div class="h-8 bg-gray-950 rounded-xl overflow-hidden p-1">
                    <div id="m-bar" class="h-full bg-gradient-to-r from-green-600 to-green-400 w-0 rounded-lg transition-all duration-75"></div>
                </div>
                <div id="m-status" class="text-center mt-6 text-6xl font-mono font-black text-green-500">0%</div>
            </div>
            <button onclick="startMic()" class="mt-10 bg-green-600 hover:bg-green-500 px-12 py-3 rounded-full font-bold transition-all">BẬT MIC</button>
        </section>

        <section id="battery" class="test-section">
            <div class="flex flex-row items-center gap-16">
                <div class="battery-body glass">
                    <div class="battery-head"></div>
                    <div id="bat-level" class="battery-level bg-green-500" style="height: 0%">
                        <i id="bat-charge" class="fas fa-bolt charge-bolt"></i>
                    </div>
                </div>
                <div class="flex flex-col gap-4">
                    <div class="glass p-5 rounded-2xl w-60 border border-white/10">
                        <p class="text-gray-400 text-[10px] uppercase font-bold">Phần trăm Pin</p>
                        <h3 id="bat-text" class="text-5xl font-black text-white">--%</h3>
                    </div>
                    <div class="glass p-5 rounded-2xl w-60 border border-white/10">
                        <p class="text-gray-400 text-[10px] uppercase font-bold">Trạng thái</p>
                        <h3 id="bat-status" class="text-xl font-bold text-blue-400">Checking...</h3>
                    </div>
                </div>
            </div>
        </section>

        <section id="battery_health" class="test-section p-8">
            <div class="max-w-4xl w-full">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="glass p-6 rounded-3xl border border-red-500/20 text-center">
                        <h3 class="text-red-400 font-bold mb-2 uppercase text-sm">Stress Test (Xả Pin)</h3>
                        <p class="text-[10px] text-gray-400 mb-6 italic">Ép máy chạy nặng để xem pin có tụt ảo hoặc sập nguồn không.</p>
                        <div class="h-4 bg-gray-900 rounded-full mb-6 p-1 border border-gray-800">
                            <div id="stress-bar" class="h-full bg-red-600 w-0 rounded-full transition-all"></div>
                        </div>
                        <button onclick="runStressTest()" id="btn-stress" class="w-full py-4 bg-red-600 hover:bg-red-500 rounded-2xl font-bold transition-all text-xs">BẮT ĐẦU TEST XẢ PIN</button>
                    </div>
                    <div class="glass p-6 rounded-3xl border border-blue-500/20 text-center">
                        <h3 class="text-blue-400 font-bold mb-2 uppercase text-sm">Báo cáo độ chai (Windows)</h3>
                        <p class="text-[10px] text-gray-400 mb-4 italic">Lấy thông số Full Charge Capacity chính xác nhất.</p>
                        <div class="bg-black/50 p-4 rounded-xl font-mono text-[11px] text-green-400 mb-6 border border-white/5 break-all">powercfg /batteryreport</div>
                        <button onclick="copyCommand()" class="w-full py-4 bg-blue-600/30 hover:bg-blue-600 border border-blue-500 rounded-2xl font-bold transition-all text-xs uppercase">Copy lệnh check chai</button>
                    </div>
                </div>
                <div class="mt-6 glass p-5 rounded-3xl border border-white/5">
                    <h3 class="text-gray-500 font-bold mb-3 text-[10px] uppercase tracking-tighter">Nhật ký Master Log</h3>
                    <div id="battery-log" class="h-28 overflow-y-auto font-mono text-[10px] text-gray-500 space-y-1 pr-2">
                        <div class="text-blue-500">> Hệ thống đã sẵn sàng kiểm tra sức khỏe pin...</div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <script>
        // HÀM CHUYỂN TAB HOÀN CHỈNH
        function showTab(id) {
            document.querySelectorAll('.test-section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.getElementById('m-' + id).classList.add('active');
            if(id === 'battery') updateBattery();
        }

        // BÀN PHÍM LOGIC
        window.addEventListener('keydown', (e) => {
            if(document.getElementById('keyboard').classList.contains('active')) {
                e.preventDefault();
                const k = document.getElementById('key-' + e.code);
                if(k) k.classList.add('key-pressed');
            }
        });
        window.addEventListener('keyup', (e) => {
            const k = document.getElementById('key-' + e.code);
            if(k) { k.classList.remove('key-pressed'); k.classList.add('key-passed'); }
        });
        function resetKb() { document.querySelectorAll('.key').forEach(k => k.classList.remove('key-passed')); }

        // CAMERA & MIC LOGIC
        async function startCam() {
            try { const s = await navigator.mediaDevices.getUserMedia({video:true}); document.getElementById('v').srcObject = s; } 
            catch(e) { alert("Lỗi Camera! Hãy kiểm tra quyền truy cập."); }
        }
        async function startMic() {
            try {
                const s = await navigator.mediaDevices.getUserMedia({audio:true});
                const ctx = new (window.AudioContext || window.webkitAudioContext)();
                const ana = ctx.createAnalyser();
                ctx.createMediaStreamSource(s).connect(ana);
                const data = new Uint8Array(ana.frequencyBinCount);
                function loop() {
                    ana.getByteFrequencyData(data);
                    let v = Math.round(data.reduce((a,b)=>a+b)/data.length * 3.5);
                    document.getElementById('m-bar').style.width = Math.min(v, 100) + "%";
                    document.getElementById('m-status').innerText = Math.min(v, 100) + "%";
                    requestAnimationFrame(loop);
                }
                loop();
            } catch(e) { alert("Lỗi Mic!"); }
        }

        // PIN TRẠNG THÁI
        function updateBattery() {
            if (!navigator.getBattery) { document.getElementById('bat-status').innerText = "Không hỗ trợ trình duyệt này"; return; }
            navigator.getBattery().then(bat => {
                const refresh = () => {
                    const lv = Math.round(bat.level * 100);
                    document.getElementById('bat-level').style.height = lv + "%";
                    document.getElementById('bat-text').innerText = lv + "%";
                    document.getElementById('bat-status').innerText = bat.charging ? "ĐANG SẠC..." : "ĐANG DÙNG PIN";
                    document.getElementById('bat-charge').style.display = bat.charging ? "block" : "none";
                };
                refresh();
                bat.onlevelchange = refresh; bat.onchargingchange = refresh;
            });
        }

        // SỨC KHỎE PIN & STRESS TEST
        let sInt;
        function runStressTest() {
            const btn = document.getElementById('btn-stress');
            const bar = document.getElementById('stress-bar');
            const log = document.getElementById('battery-log');
            if (btn.innerText.includes("BẮT ĐẦU")) {
                btn.innerText = "DỪNG TEST (CPU 100%)";
                btn.classList.add('bg-orange-600');
                let p = 0;
                sInt = setInterval(() => {
                    p = (p + 10) % 100; bar.style.width = p + "%";
                    let el = document.createElement('div');
                    el.innerHTML = `<span>[${new Date().toLocaleTimeString()}]</span> <span class="text-red-400">Ép tải:</span> Đang xả pin kiểm tra cell...`;
                    log.prepend(el);
                    for(let i=0; i<3000000; i++) { Math.sqrt(i); }
                }, 1000);
            } else {
                clearInterval(sInt);
                btn.innerText = "BẮT ĐẦU TEST XẢ PIN";
                btn.classList.remove('bg-orange-600');
                bar.style.width = "0%";
            }
        }
        function copyCommand() {
            navigator.clipboard.writeText("powercfg /batteryreport");
            alert("Đã copy lệnh! Anh Duy dán vào CMD để check chai pin nhé.");
        }
    </script>
</body>
</html>
